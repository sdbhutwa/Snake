{"version":3,"sources":["../node_modules/browser-pack/_prelude.js","field.ts","game.ts","globals.ts","main.ts","painter.ts","random.ts","snake.ts"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","\r\nimport { Painter } from \"./painter\";\r\nimport { getRandomInt } from \"./random\";\r\n\r\nexport enum FieldSize\r\n{\r\n    Width = 20, Height = 20\r\n}\r\n\r\nexport enum BlockSize\r\n{\r\n    Width = 10, Height = 10\r\n}\r\n\r\nexport enum BlockType\r\n{\r\n    Empty, SnakeBlock, Fruit\r\n}\r\n\r\nexport class Field\r\n{\r\n    private _m: any[] = [];\r\n\r\n    public constructor()\r\n    {\r\n        for (let y = 0; y < FieldSize.Height; ++y)\r\n        {\r\n            let columns: BlockType[] = [];\r\n            for (let x = 0; x < FieldSize.Width; ++x)\r\n            {\r\n                columns[x] = BlockType.Empty;\r\n            }\r\n            this._m[y] = columns;\r\n        }\r\n        this.NewFruit();\r\n    }\r\n\r\n    public SetBlock(type: BlockType, x: number, y: number)\r\n    {\r\n        this._m[y][x] = type;\r\n    }\r\n\r\n    public GetBlock(x: number, y: number): BlockType\r\n    {\r\n        return this._m[y][x];\r\n    }\r\n\r\n    public Draw(p: Painter): void\r\n    {\r\n        for (let y = 0; y < FieldSize.Height; ++y)\r\n        {\r\n            for (let x = 0; x < FieldSize.Width; ++x)\r\n            {\r\n                switch (this._m[y][x])\r\n                {\r\n                    case BlockType.Empty:\r\n                        break;\r\n                    case BlockType.SnakeBlock:\r\n                        p.Bar(x * BlockSize.Width + BlockSize.Width / 2,\r\n                            y * BlockSize.Height + BlockSize.Height / 2,\r\n                            BlockSize.Width - 1, BlockSize.Height - 1);\r\n                        break;\r\n                    case BlockType.Fruit:\r\n                        p.Circle(x * BlockSize.Width + BlockSize.Width / 2,\r\n                            y * BlockSize.Height + BlockSize.Height / 2, BlockSize.Width - 1);\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    public NewFruit(): void\r\n    {\r\n        let x: number;\r\n        let y: number;\r\n        do\r\n        {\r\n            x = getRandomInt(0, FieldSize.Width - 1);\r\n            y = getRandomInt(0, FieldSize.Height - 1);\r\n        } while (this.GetBlock(x, y) != BlockType.Empty);\r\n        this.SetBlock(BlockType.Fruit, x, y);\r\n    }\r\n}","\r\nimport { Painter } from \"./painter\";\r\nimport { Field } from \"./field\";\r\nimport { Snake, SnakeDirection } from \"./snake\";\r\n\r\nexport class Game\r\n{\r\n    private _field: Field = null;\r\n    private _snake: Snake = null;\r\n\r\n    public constructor()\r\n    {\r\n        this._field = new Field();\r\n        this._snake = new Snake();\r\n    }\r\n\r\n    public Tick(): void\r\n    {\r\n        if (!this._snake.Tick(this._field))\r\n        {\r\n            this._field = new Field();\r\n            this._snake = new Snake();\r\n        }\r\n    }\r\n\r\n    public Draw(p: Painter): void\r\n    {\r\n        this._field.Draw(p);\r\n    }\r\n\r\n    public KeyEvent(d: SnakeDirection)\r\n    {\r\n        this._snake.KeyEvent(d);\r\n    }\r\n}","\r\nexport let gl: WebGLRenderingContext = null;\r\nexport let simpleShaderProgram: WebGLProgram = null;\r\nexport let shaderVertexPositionAttribute: number;\r\nexport let u_FragColor: WebGLUniformLocation = null;\r\nexport let u_ModelTransform: WebGLUniformLocation = null;\r\nexport let u_ProjTransform: WebGLUniformLocation = null;\r\n\r\nlet gSquareVertexBuffer: WebGLBuffer = null;\r\n\r\nexport function initGL(canvas: HTMLCanvasElement): boolean\r\n{\r\n    // Get the rendering context\r\n    gl = getWebGLContext(canvas);\r\n    if (gl == null)\r\n    {\r\n        console.log(\"Failed to get the rendering context\");\r\n        return false;\r\n    }\r\n\r\n    initSquareBuffer();\r\n\r\n    if (!initSimpleShader(\"VertexShader\", \"FragmentShader\"))\r\n    {\r\n        return false;\r\n    }\r\n\r\n    u_FragColor = gl.getUniformLocation(simpleShaderProgram, \"u_FragColor\");\r\n    if (!u_FragColor)\r\n    {\r\n        console.log(\"Failed to get u_FragColor location\");\r\n        return false;\r\n    }\r\n\r\n    u_ModelTransform = gl.getUniformLocation(simpleShaderProgram, \"u_ModelTransform\");\r\n    if (!u_ModelTransform)\r\n    {\r\n        console.log(\"Failed to get u_ModelTransfrom location\");\r\n        return false;\r\n    }\r\n\r\n    u_ProjTransform = gl.getUniformLocation(simpleShaderProgram, \"u_ProjTransform\");\r\n    if (!u_ProjTransform)\r\n    {\r\n        console.log(\"Faile to get u_ProjTransform location\");\r\n        return false;\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\nfunction getWebGLContext(canvas: HTMLCanvasElement): WebGLRenderingContext\r\n{\r\n    let gl: WebGLRenderingContext = null;\r\n\r\n    try\r\n    {\r\n        gl = canvas.getContext(\"webgl\") || canvas.getContext(\"experimental-webgl\");\r\n\r\n        if (gl == null)\r\n        {\r\n            throw \"Browser does not support WebGL\";\r\n        }\r\n    }\r\n    catch (e)\r\n    {\r\n        console.log(e);\r\n    }\r\n\r\n    return gl;\r\n}\r\n\r\nfunction initSquareBuffer(): void\r\n{\r\n    // Define the vertices for a square\r\n    let verticesOfSquare = [\r\n        0.5, 0.5, 0.0,\r\n        -0.5, 0.5, 0.0,\r\n        0.5, -0.5, 0.0,\r\n        -0.5, -0.5, 0.0,\r\n\r\n        0.0, 0.5, 0.0,\r\n        -0.5, 0.0, 0.0,\r\n        0.5, 0.0, 0.0,\r\n        0.0, -0.5, 0.0\r\n    ];\r\n\r\n    // Create a buffer on the gl context\r\n    gSquareVertexBuffer = gl.createBuffer();\r\n\r\n    // Activate vertexBuffer\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, gSquareVertexBuffer);\r\n\r\n    // Loads verticesOfSquare into the vertexBuffer\r\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(verticesOfSquare), gl.STATIC_DRAW);\r\n}\r\n\r\nfunction initSimpleShader(vertexShaderID: string, fragmentShaderID: string): boolean\r\n{\r\n    // Load and compile vertex and fragment shaders\r\n    let vertexShader = loadAndCompileShader(vertexShaderID, gl.VERTEX_SHADER);\r\n    let fragmentShader = loadAndCompileShader(fragmentShaderID, gl.FRAGMENT_SHADER);\r\n    if (!vertexShader || !fragmentShader)\r\n    {\r\n        return false;\r\n    }\r\n\r\n    // Create and link the shaders to a program\r\n    simpleShaderProgram = gl.createProgram();\r\n    gl.attachShader(simpleShaderProgram, vertexShader);\r\n    gl.attachShader(simpleShaderProgram, fragmentShader);\r\n    gl.linkProgram(simpleShaderProgram);\r\n\r\n    // Check for error\r\n    if (!gl.getProgramParameter(simpleShaderProgram, gl.LINK_STATUS))\r\n    {\r\n        console.log(\"Error linking shader\");\r\n        return false;\r\n    }\r\n\r\n    // Gets a reference to the a_Position variable within the shaders\r\n    shaderVertexPositionAttribute = gl.getAttribLocation(simpleShaderProgram, \"a_Position\");\r\n    if (shaderVertexPositionAttribute < 0)\r\n    {\r\n        console.log(\"Failed to get a reference to the a_Position variable\")\r\n        return false;\r\n    }\r\n\r\n    // Activates the vertex buffer\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, gSquareVertexBuffer);\r\n\r\n    // Discribe the characteristic of the vertex position attribute\r\n    gl.vertexAttribPointer(shaderVertexPositionAttribute,\r\n        3,          // each vertex element is a 3-float (x, y, z)\r\n        gl.FLOAT,   // data type is FLOAT\r\n        false,      // if the content is normalized vectors\r\n        0,          // number of bytes to skip in bitween elements\r\n        0           // offsets to the first element\r\n    );\r\n\r\n    return true;\r\n}\r\n\r\nfunction loadAndCompileShader(id: string, shaderType: number): WebGLShader\r\n{\r\n    // Get the shader source from index.html\r\n    let shaderText = document.getElementById(id);\r\n    let shaderSource = shaderText.firstChild.textContent;\r\n\r\n    // Create the shader based on the shader type: vertex or fragment\r\n    let compiledShader = gl.createShader(shaderType);\r\n\r\n    // Compile the created shader\r\n    gl.shaderSource(compiledShader, shaderSource);\r\n    gl.compileShader(compiledShader);\r\n\r\n    // Check for errors and return results (null if error)\r\n    if (!gl.getShaderParameter(compiledShader, gl.COMPILE_STATUS))\r\n    {\r\n        console.log(`A shader compiling error occured: ${gl.getShaderInfoLog(compiledShader)}`);\r\n        return null;\r\n    }\r\n\r\n    return compiledShader;\r\n}","\r\nimport { Painter } from \"./painter\";\r\nimport { Game } from \"./game\";\r\nimport { SnakeDirection } from \"./snake\";\r\n\r\nimport\r\n{\r\n    gl, initGL\r\n} from \"./globals\";\r\n\r\nlet game = new Game();\r\nlet painter = new Painter();\r\n\r\nfunction display()\r\n{\r\n    gl.clear(gl.COLOR_BUFFER_BIT);\r\n    game.Draw(painter);\r\n}\r\n\r\nfunction timer()\r\n{\r\n    game.Tick();\r\n    display();\r\n}\r\n\r\nfunction keyEvent(event: KeyboardEvent)\r\n{\r\n    switch (event.keyCode)\r\n    {\r\n        case 65: // A\r\n        case 37: // Left Arrow\r\n            game.KeyEvent(SnakeDirection.Left);\r\n            break;\r\n        case 87: // W\r\n        case 38: // Up Arrow\r\n            game.KeyEvent(SnakeDirection.Up);\r\n            break;\r\n        case 68: // D\r\n        case 39: // Right Arrow\r\n            game.KeyEvent(SnakeDirection.Right);\r\n            break;\r\n        case 83: // S\r\n        case 40: // Down Arrow\r\n            game.KeyEvent(SnakeDirection.Down);\r\n            break;\r\n    }\r\n}\r\n\r\nfunction main()\r\n{\r\n    // Retrieve the canvas element\r\n    let canvas = document.getElementById(\"renderCanvas\") as HTMLCanvasElement;\r\n    if (canvas == null)\r\n    {\r\n        console.log(\"Failed to retrieve the canvas element\");\r\n        return;\r\n    }\r\n\r\n    // Initialize GL\r\n    if (!initGL(canvas))\r\n    {\r\n        console.log(\"Failed to initialize GL\");\r\n        return;\r\n    }\r\n\r\n    gl.clearColor(0.0, 0.0, 0.0, 1.0);\r\n\r\n    window.addEventListener(\"keydown\", keyEvent);\r\n\r\n    setInterval(timer, 300);\r\n}\r\n\r\nmain();\r\n","/// <reference path=\"./lib/gl-matrix.d.ts\" />\r\n\r\nimport { FieldSize, BlockSize } from \"./field\";\r\n\r\nimport\r\n{\r\n    gl, simpleShaderProgram,\r\n    shaderVertexPositionAttribute,\r\n    u_FragColor, u_ModelTransform,\r\n    u_ProjTransform\r\n} from \"./globals\";\r\n\r\nexport class Painter\r\n{\r\n    public Bar(x: number, y: number, width: number, height: number): void\r\n    {\r\n        this.ActiveShader([0.0, 1.0, 0.0, 1.0]);\r\n        this.SetProjectionMatrix();\r\n        this.Transform(x, y, width, height);\r\n\r\n        // Draw with the above settings\r\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\r\n    }\r\n\r\n    public Circle(x: number, y: number, diameter: number): void\r\n    {\r\n        this.ActiveShader([1.0, 0.0, 0.0, 1.0]);\r\n        this.SetProjectionMatrix();\r\n        this.Transform(x, y, diameter, diameter);\r\n\r\n        // Draw with the above settings\r\n        gl.drawArrays(gl.TRIANGLE_STRIP, 4, 4);\r\n    }\r\n\r\n    private SetProjectionMatrix()\r\n    {\r\n        let projMatrix = mat4.create();\r\n        mat4.ortho(projMatrix,\r\n            0, FieldSize.Width * BlockSize.Width,\r\n            FieldSize.Height * BlockSize.Width, 0, 1, -1);\r\n        gl.uniformMatrix4fv(u_ProjTransform, false, projMatrix);\r\n    }\r\n\r\n    private ActiveShader(color: number[])\r\n    {\r\n        // Enable the shader to use\r\n        gl.useProgram(simpleShaderProgram);\r\n\r\n        // Enable the vertex position attribute\r\n        gl.enableVertexAttribArray(shaderVertexPositionAttribute);\r\n\r\n        // Set Color\r\n        gl.uniform4fv(u_FragColor, color);\r\n    }\r\n\r\n    private Transform(x: number, y: number, w: number, h: number)\r\n    {\r\n        // Creates a blank identity matrix\r\n        let matrix = mat4.create();\r\n\r\n        // Compute translation and scaling\r\n        mat4.translate(matrix, matrix, vec3.fromValues(x, y, 0.0));\r\n        //mat4.rotateZ(matrix, matrix, 0.0);\r\n        mat4.scale(matrix, matrix, vec3.fromValues(w, h, 1.0));\r\n\r\n        // Loads the modelTransform matrix into WebGL to be used by the vertex shader\r\n        gl.uniformMatrix4fv(u_ModelTransform, false, matrix);\r\n    }\r\n}","/**\r\n * Get a random floating point number between `min` and `max`.\r\n * \r\n * @param {number} min - min number\r\n * @param {number} max - max number\r\n * @return {float} a random floating point number\r\n */\r\nexport function getRandom(min, max)\r\n{\r\n    return Math.random() * (max - min) + min;\r\n}\r\n\r\n/**\r\n * Get a random integer between `min` and `max`.\r\n * \r\n * @param {number} min - min number\r\n * @param {number} max - max number\r\n * @return {int} a random integer\r\n */\r\nexport function getRandomInt(min, max)\r\n{\r\n    return Math.floor(Math.random() * (max - min + 1) + min);\r\n}\r\n","\r\nimport { Field, FieldSize, BlockType } from \"./field\";\r\nimport { getRandomInt } from \"./random\";\r\n\r\nexport enum SnakeDirection\r\n{\r\n    Left, Up, Right, Down\r\n}\r\n\r\nexport class Snake\r\n{\r\n    private _snakeBlocks: { x: number, y: number }[] = [];\r\n    private _direction: SnakeDirection;\r\n    private _lastMove: SnakeDirection;\r\n\r\n    public constructor()\r\n    {\r\n        this._snakeBlocks.push({ x: FieldSize.Width / 2, y: FieldSize.Height / 2 });\r\n        this._direction = getRandomInt(0, 3) as SnakeDirection;\r\n        this._lastMove = this._direction;\r\n    }\r\n\r\n    public Tick(field: Field): boolean\r\n    {\r\n        this._lastMove = this._direction;\r\n        let p = Object.create(this._snakeBlocks[0]);\r\n\r\n        switch (this._direction)\r\n        {\r\n            case SnakeDirection.Left:\r\n                p.x--;\r\n                break;\r\n            case SnakeDirection.Up:\r\n                p.y--;\r\n                break;\r\n            case SnakeDirection.Right:\r\n                p.x++;\r\n                break;\r\n            case SnakeDirection.Down:\r\n                p.y++;\r\n                break;\r\n        }\r\n\r\n        if (p.x < 0 || p.x >= FieldSize.Width || p.y < 0 || p.y >= FieldSize.Height)\r\n        {\r\n            return false;\r\n        }\r\n\r\n        if (field.GetBlock(p.x, p.y) == BlockType.SnakeBlock)\r\n        {\r\n            return false;\r\n        }\r\n\r\n        this._snakeBlocks.unshift(p);\r\n\r\n        if (field.GetBlock(p.x, p.y) != BlockType.Fruit)\r\n        {\r\n            field.SetBlock(BlockType.SnakeBlock, p.x, p.y);\r\n            let x = this._snakeBlocks[this._snakeBlocks.length - 1].x;\r\n            let y = this._snakeBlocks[this._snakeBlocks.length - 1].y;\r\n            field.SetBlock(BlockType.Empty, x, y);\r\n            this._snakeBlocks.pop();\r\n        }\r\n        else\r\n        {\r\n            field.SetBlock(BlockType.SnakeBlock, p.x, p.y);\r\n            field.NewFruit();\r\n        }\r\n\r\n        if (this._snakeBlocks.length >= FieldSize.Width * FieldSize.Height - 1)\r\n        {\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    public KeyEvent(d: SnakeDirection)\r\n    {\r\n        if (d == this._direction)\r\n        {\r\n            return;\r\n        }\r\n\r\n        switch (d)\r\n        {\r\n            case SnakeDirection.Left:\r\n                if (this._lastMove == SnakeDirection.Right)\r\n                {\r\n                    return;\r\n                }\r\n                break;\r\n            case SnakeDirection.Up:\r\n                if (this._lastMove == SnakeDirection.Down)\r\n                {\r\n                    return;\r\n                }\r\n                break;\r\n            case SnakeDirection.Right:\r\n                if (this._lastMove == SnakeDirection.Left)\r\n                {\r\n                    return;\r\n                }\r\n                break;\r\n            case SnakeDirection.Down:\r\n                if (this._lastMove == SnakeDirection.Up)\r\n                {\r\n                    return;\r\n                }\r\n                break;\r\n        }\r\n\r\n        this._direction = d;\r\n    }\r\n}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJmaWVsZC50cyIsImdhbWUudHMiLCJnbG9iYWxzLnRzIiwibWFpbi50cyIsInBhaW50ZXIudHMiLCJyYW5kb20udHMiLCJzbmFrZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDRUEsbUNBQXdDO0FBRXhDLElBQVksU0FHWDtBQUhELFdBQVksU0FBUztJQUVqQiw0Q0FBVSxDQUFBO0lBQUUsOENBQVcsQ0FBQTtBQUMzQixDQUFDLEVBSFcsU0FBUyxHQUFULGlCQUFTLEtBQVQsaUJBQVMsUUFHcEI7QUFFRCxJQUFZLFNBR1g7QUFIRCxXQUFZLFNBQVM7SUFFakIsNENBQVUsQ0FBQTtJQUFFLDhDQUFXLENBQUE7QUFDM0IsQ0FBQyxFQUhXLFNBQVMsR0FBVCxpQkFBUyxLQUFULGlCQUFTLFFBR3BCO0FBRUQsSUFBWSxTQUdYO0FBSEQsV0FBWSxTQUFTO0lBRWpCLDJDQUFLLENBQUE7SUFBRSxxREFBVSxDQUFBO0lBQUUsMkNBQUssQ0FBQTtBQUM1QixDQUFDLEVBSFcsU0FBUyxHQUFULGlCQUFTLEtBQVQsaUJBQVMsUUFHcEI7QUFFRDtJQUlJO1FBRlEsT0FBRSxHQUFVLEVBQUUsQ0FBQztRQUluQixHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLEVBQ3pDLENBQUM7WUFDRyxJQUFJLE9BQU8sR0FBZ0IsRUFBRSxDQUFDO1lBQzlCLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsU0FBUyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsRUFDeEMsQ0FBQztnQkFDRyxPQUFPLENBQUMsQ0FBQyxDQUFDLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQztZQUNqQyxDQUFDO1lBQ0QsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxPQUFPLENBQUM7UUFDekIsQ0FBQztRQUNELElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUNwQixDQUFDO0lBRU0sd0JBQVEsR0FBZixVQUFnQixJQUFlLEVBQUUsQ0FBUyxFQUFFLENBQVM7UUFFakQsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUM7SUFDekIsQ0FBQztJQUVNLHdCQUFRLEdBQWYsVUFBZ0IsQ0FBUyxFQUFFLENBQVM7UUFFaEMsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDekIsQ0FBQztJQUVNLG9CQUFJLEdBQVgsVUFBWSxDQUFVO1FBRWxCLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsU0FBUyxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUMsRUFDekMsQ0FBQztZQUNHLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsU0FBUyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsRUFDeEMsQ0FBQztnQkFDRyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQ3RCLENBQUM7b0JBQ0csS0FBSyxTQUFTLENBQUMsS0FBSzt3QkFDaEIsS0FBSyxDQUFDO29CQUNWLEtBQUssU0FBUyxDQUFDLFVBQVU7d0JBQ3JCLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxLQUFLLEdBQUcsU0FBUyxDQUFDLEtBQUssR0FBRyxDQUFDLEVBQzNDLENBQUMsR0FBRyxTQUFTLENBQUMsTUFBTSxHQUFHLFNBQVMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUMzQyxTQUFTLENBQUMsS0FBSyxHQUFHLENBQUMsRUFBRSxTQUFTLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDO3dCQUMvQyxLQUFLLENBQUM7b0JBQ1YsS0FBSyxTQUFTLENBQUMsS0FBSzt3QkFDaEIsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEdBQUcsU0FBUyxDQUFDLEtBQUssR0FBRyxTQUFTLENBQUMsS0FBSyxHQUFHLENBQUMsRUFDOUMsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxNQUFNLEdBQUcsU0FBUyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsU0FBUyxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQzt3QkFDdEUsS0FBSyxDQUFDO2dCQUNkLENBQUM7WUFDTCxDQUFDO1FBQ0wsQ0FBQztJQUNMLENBQUM7SUFFTSx3QkFBUSxHQUFmO1FBRUksSUFBSSxDQUFTLENBQUM7UUFDZCxJQUFJLENBQVMsQ0FBQztRQUNkLEdBQ0EsQ0FBQztZQUNHLENBQUMsR0FBRyxxQkFBWSxDQUFDLENBQUMsRUFBRSxTQUFTLENBQUMsS0FBSyxHQUFHLENBQUMsQ0FBQyxDQUFDO1lBQ3pDLENBQUMsR0FBRyxxQkFBWSxDQUFDLENBQUMsRUFBRSxTQUFTLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQzlDLENBQUMsUUFBUSxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxTQUFTLENBQUMsS0FBSyxFQUFFO1FBQ2pELElBQUksQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDekMsQ0FBQztJQUNMLFlBQUM7QUFBRCxDQS9EQSxBQStEQyxJQUFBO0FBL0RZLHNCQUFLOzs7O0FDakJsQixpQ0FBZ0M7QUFDaEMsaUNBQWdEO0FBRWhEO0lBS0k7UUFIUSxXQUFNLEdBQVUsSUFBSSxDQUFDO1FBQ3JCLFdBQU0sR0FBVSxJQUFJLENBQUM7UUFJekIsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLGFBQUssRUFBRSxDQUFDO1FBQzFCLElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxhQUFLLEVBQUUsQ0FBQztJQUM5QixDQUFDO0lBRU0sbUJBQUksR0FBWDtRQUVJLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQ25DLENBQUM7WUFDRyxJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksYUFBSyxFQUFFLENBQUM7WUFDMUIsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLGFBQUssRUFBRSxDQUFDO1FBQzlCLENBQUM7SUFDTCxDQUFDO0lBRU0sbUJBQUksR0FBWCxVQUFZLENBQVU7UUFFbEIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDeEIsQ0FBQztJQUVNLHVCQUFRLEdBQWYsVUFBZ0IsQ0FBaUI7UUFFN0IsSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDNUIsQ0FBQztJQUNMLFdBQUM7QUFBRCxDQTdCQSxBQTZCQyxJQUFBO0FBN0JZLG9CQUFJOzs7O0FDSk4sUUFBQSxFQUFFLEdBQTBCLElBQUksQ0FBQztBQUNqQyxRQUFBLG1CQUFtQixHQUFpQixJQUFJLENBQUM7QUFFekMsUUFBQSxXQUFXLEdBQXlCLElBQUksQ0FBQztBQUN6QyxRQUFBLGdCQUFnQixHQUF5QixJQUFJLENBQUM7QUFDOUMsUUFBQSxlQUFlLEdBQXlCLElBQUksQ0FBQztBQUV4RCxJQUFJLG1CQUFtQixHQUFnQixJQUFJLENBQUM7QUFFNUMsZ0JBQXVCLE1BQXlCO0lBRTVDLDRCQUE0QjtJQUM1QixVQUFFLEdBQUcsZUFBZSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQzdCLEVBQUUsQ0FBQyxDQUFDLFVBQUUsSUFBSSxJQUFJLENBQUMsQ0FDZixDQUFDO1FBQ0csT0FBTyxDQUFDLEdBQUcsQ0FBQyxxQ0FBcUMsQ0FBQyxDQUFDO1FBQ25ELE1BQU0sQ0FBQyxLQUFLLENBQUM7SUFDakIsQ0FBQztJQUVELGdCQUFnQixFQUFFLENBQUM7SUFFbkIsRUFBRSxDQUFDLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxjQUFjLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQyxDQUN4RCxDQUFDO1FBQ0csTUFBTSxDQUFDLEtBQUssQ0FBQztJQUNqQixDQUFDO0lBRUQsbUJBQVcsR0FBRyxVQUFFLENBQUMsa0JBQWtCLENBQUMsMkJBQW1CLEVBQUUsYUFBYSxDQUFDLENBQUM7SUFDeEUsRUFBRSxDQUFDLENBQUMsQ0FBQyxtQkFBVyxDQUFDLENBQ2pCLENBQUM7UUFDRyxPQUFPLENBQUMsR0FBRyxDQUFDLG9DQUFvQyxDQUFDLENBQUM7UUFDbEQsTUFBTSxDQUFDLEtBQUssQ0FBQztJQUNqQixDQUFDO0lBRUQsd0JBQWdCLEdBQUcsVUFBRSxDQUFDLGtCQUFrQixDQUFDLDJCQUFtQixFQUFFLGtCQUFrQixDQUFDLENBQUM7SUFDbEYsRUFBRSxDQUFDLENBQUMsQ0FBQyx3QkFBZ0IsQ0FBQyxDQUN0QixDQUFDO1FBQ0csT0FBTyxDQUFDLEdBQUcsQ0FBQyx5Q0FBeUMsQ0FBQyxDQUFDO1FBQ3ZELE1BQU0sQ0FBQyxLQUFLLENBQUM7SUFDakIsQ0FBQztJQUVELHVCQUFlLEdBQUcsVUFBRSxDQUFDLGtCQUFrQixDQUFDLDJCQUFtQixFQUFFLGlCQUFpQixDQUFDLENBQUM7SUFDaEYsRUFBRSxDQUFDLENBQUMsQ0FBQyx1QkFBZSxDQUFDLENBQ3JCLENBQUM7UUFDRyxPQUFPLENBQUMsR0FBRyxDQUFDLHVDQUF1QyxDQUFDLENBQUM7UUFDckQsTUFBTSxDQUFDLEtBQUssQ0FBQztJQUNqQixDQUFDO0lBRUQsTUFBTSxDQUFDLElBQUksQ0FBQztBQUNoQixDQUFDO0FBdkNELHdCQXVDQztBQUVELHlCQUF5QixNQUF5QjtJQUU5QyxJQUFJLEVBQUUsR0FBMEIsSUFBSSxDQUFDO0lBRXJDLElBQ0EsQ0FBQztRQUNHLEVBQUUsR0FBRyxNQUFNLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxJQUFJLE1BQU0sQ0FBQyxVQUFVLENBQUMsb0JBQW9CLENBQUMsQ0FBQztRQUUzRSxFQUFFLENBQUMsQ0FBQyxFQUFFLElBQUksSUFBSSxDQUFDLENBQ2YsQ0FBQztZQUNHLE1BQU0sZ0NBQWdDLENBQUM7UUFDM0MsQ0FBQztJQUNMLENBQUM7SUFDRCxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FDVCxDQUFDO1FBQ0csT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNuQixDQUFDO0lBRUQsTUFBTSxDQUFDLEVBQUUsQ0FBQztBQUNkLENBQUM7QUFFRDtJQUVJLG1DQUFtQztJQUNuQyxJQUFJLGdCQUFnQixHQUFHO1FBQ25CLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRztRQUNiLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHO1FBQ2QsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUFFLEdBQUc7UUFDZCxDQUFDLEdBQUcsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHO1FBRWYsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHO1FBQ2IsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUc7UUFDZCxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUc7UUFDYixHQUFHLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRztLQUNqQixDQUFDO0lBRUYsb0NBQW9DO0lBQ3BDLG1CQUFtQixHQUFHLFVBQUUsQ0FBQyxZQUFZLEVBQUUsQ0FBQztJQUV4Qyx3QkFBd0I7SUFDeEIsVUFBRSxDQUFDLFVBQVUsQ0FBQyxVQUFFLENBQUMsWUFBWSxFQUFFLG1CQUFtQixDQUFDLENBQUM7SUFFcEQsK0NBQStDO0lBQy9DLFVBQUUsQ0FBQyxVQUFVLENBQUMsVUFBRSxDQUFDLFlBQVksRUFBRSxJQUFJLFlBQVksQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLFVBQUUsQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUN2RixDQUFDO0FBRUQsMEJBQTBCLGNBQXNCLEVBQUUsZ0JBQXdCO0lBRXRFLCtDQUErQztJQUMvQyxJQUFJLFlBQVksR0FBRyxvQkFBb0IsQ0FBQyxjQUFjLEVBQUUsVUFBRSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQzFFLElBQUksY0FBYyxHQUFHLG9CQUFvQixDQUFDLGdCQUFnQixFQUFFLFVBQUUsQ0FBQyxlQUFlLENBQUMsQ0FBQztJQUNoRixFQUFFLENBQUMsQ0FBQyxDQUFDLFlBQVksSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUNyQyxDQUFDO1FBQ0csTUFBTSxDQUFDLEtBQUssQ0FBQztJQUNqQixDQUFDO0lBRUQsMkNBQTJDO0lBQzNDLDJCQUFtQixHQUFHLFVBQUUsQ0FBQyxhQUFhLEVBQUUsQ0FBQztJQUN6QyxVQUFFLENBQUMsWUFBWSxDQUFDLDJCQUFtQixFQUFFLFlBQVksQ0FBQyxDQUFDO0lBQ25ELFVBQUUsQ0FBQyxZQUFZLENBQUMsMkJBQW1CLEVBQUUsY0FBYyxDQUFDLENBQUM7SUFDckQsVUFBRSxDQUFDLFdBQVcsQ0FBQywyQkFBbUIsQ0FBQyxDQUFDO0lBRXBDLGtCQUFrQjtJQUNsQixFQUFFLENBQUMsQ0FBQyxDQUFDLFVBQUUsQ0FBQyxtQkFBbUIsQ0FBQywyQkFBbUIsRUFBRSxVQUFFLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FDakUsQ0FBQztRQUNHLE9BQU8sQ0FBQyxHQUFHLENBQUMsc0JBQXNCLENBQUMsQ0FBQztRQUNwQyxNQUFNLENBQUMsS0FBSyxDQUFDO0lBQ2pCLENBQUM7SUFFRCxpRUFBaUU7SUFDakUscUNBQTZCLEdBQUcsVUFBRSxDQUFDLGlCQUFpQixDQUFDLDJCQUFtQixFQUFFLFlBQVksQ0FBQyxDQUFDO0lBQ3hGLEVBQUUsQ0FBQyxDQUFDLHFDQUE2QixHQUFHLENBQUMsQ0FBQyxDQUN0QyxDQUFDO1FBQ0csT0FBTyxDQUFDLEdBQUcsQ0FBQyxzREFBc0QsQ0FBQyxDQUFBO1FBQ25FLE1BQU0sQ0FBQyxLQUFLLENBQUM7SUFDakIsQ0FBQztJQUVELDhCQUE4QjtJQUM5QixVQUFFLENBQUMsVUFBVSxDQUFDLFVBQUUsQ0FBQyxZQUFZLEVBQUUsbUJBQW1CLENBQUMsQ0FBQztJQUVwRCwrREFBK0Q7SUFDL0QsVUFBRSxDQUFDLG1CQUFtQixDQUFDLHFDQUE2QixFQUNoRCxDQUFDLEVBQVcsNkNBQTZDO0lBQ3pELFVBQUUsQ0FBQyxLQUFLLEVBQUkscUJBQXFCO0lBQ2pDLEtBQUssRUFBTyx1Q0FBdUM7SUFDbkQsQ0FBQyxFQUFXLDhDQUE4QztJQUMxRCxDQUFDLENBQVcsK0JBQStCO0tBQzlDLENBQUM7SUFFRixNQUFNLENBQUMsSUFBSSxDQUFDO0FBQ2hCLENBQUM7QUFFRCw4QkFBOEIsRUFBVSxFQUFFLFVBQWtCO0lBRXhELHdDQUF3QztJQUN4QyxJQUFJLFVBQVUsR0FBRyxRQUFRLENBQUMsY0FBYyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQzdDLElBQUksWUFBWSxHQUFHLFVBQVUsQ0FBQyxVQUFVLENBQUMsV0FBVyxDQUFDO0lBRXJELGlFQUFpRTtJQUNqRSxJQUFJLGNBQWMsR0FBRyxVQUFFLENBQUMsWUFBWSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBRWpELDZCQUE2QjtJQUM3QixVQUFFLENBQUMsWUFBWSxDQUFDLGNBQWMsRUFBRSxZQUFZLENBQUMsQ0FBQztJQUM5QyxVQUFFLENBQUMsYUFBYSxDQUFDLGNBQWMsQ0FBQyxDQUFDO0lBRWpDLHNEQUFzRDtJQUN0RCxFQUFFLENBQUMsQ0FBQyxDQUFDLFVBQUUsQ0FBQyxrQkFBa0IsQ0FBQyxjQUFjLEVBQUUsVUFBRSxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQzlELENBQUM7UUFDRyxPQUFPLENBQUMsR0FBRyxDQUFDLHVDQUFxQyxVQUFFLENBQUMsZ0JBQWdCLENBQUMsY0FBYyxDQUFHLENBQUMsQ0FBQztRQUN4RixNQUFNLENBQUMsSUFBSSxDQUFDO0lBQ2hCLENBQUM7SUFFRCxNQUFNLENBQUMsY0FBYyxDQUFDO0FBQzFCLENBQUM7Ozs7QUNuS0QscUNBQW9DO0FBQ3BDLCtCQUE4QjtBQUM5QixpQ0FBeUM7QUFFekMscUNBR21CO0FBRW5CLElBQUksSUFBSSxHQUFHLElBQUksV0FBSSxFQUFFLENBQUM7QUFDdEIsSUFBSSxPQUFPLEdBQUcsSUFBSSxpQkFBTyxFQUFFLENBQUM7QUFFNUI7SUFFSSxZQUFFLENBQUMsS0FBSyxDQUFDLFlBQUUsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO0lBQzlCLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDdkIsQ0FBQztBQUVEO0lBRUksSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQ1osT0FBTyxFQUFFLENBQUM7QUFDZCxDQUFDO0FBRUQsa0JBQWtCLEtBQW9CO0lBRWxDLE1BQU0sQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FDdEIsQ0FBQztRQUNHLEtBQUssRUFBRSxDQUFDLENBQUMsSUFBSTtRQUNiLEtBQUssRUFBRTtZQUNILElBQUksQ0FBQyxRQUFRLENBQUMsc0JBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNuQyxLQUFLLENBQUM7UUFDVixLQUFLLEVBQUUsQ0FBQyxDQUFDLElBQUk7UUFDYixLQUFLLEVBQUU7WUFDSCxJQUFJLENBQUMsUUFBUSxDQUFDLHNCQUFjLENBQUMsRUFBRSxDQUFDLENBQUM7WUFDakMsS0FBSyxDQUFDO1FBQ1YsS0FBSyxFQUFFLENBQUMsQ0FBQyxJQUFJO1FBQ2IsS0FBSyxFQUFFO1lBQ0gsSUFBSSxDQUFDLFFBQVEsQ0FBQyxzQkFBYyxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ3BDLEtBQUssQ0FBQztRQUNWLEtBQUssRUFBRSxDQUFDLENBQUMsSUFBSTtRQUNiLEtBQUssRUFBRTtZQUNILElBQUksQ0FBQyxRQUFRLENBQUMsc0JBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNuQyxLQUFLLENBQUM7SUFDZCxDQUFDO0FBQ0wsQ0FBQztBQUVEO0lBRUksOEJBQThCO0lBQzlCLElBQUksTUFBTSxHQUFHLFFBQVEsQ0FBQyxjQUFjLENBQUMsY0FBYyxDQUFzQixDQUFDO0lBQzFFLEVBQUUsQ0FBQyxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsQ0FDbkIsQ0FBQztRQUNHLE9BQU8sQ0FBQyxHQUFHLENBQUMsdUNBQXVDLENBQUMsQ0FBQztRQUNyRCxNQUFNLENBQUM7SUFDWCxDQUFDO0lBRUQsZ0JBQWdCO0lBQ2hCLEVBQUUsQ0FBQyxDQUFDLENBQUMsZ0JBQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUNwQixDQUFDO1FBQ0csT0FBTyxDQUFDLEdBQUcsQ0FBQyx5QkFBeUIsQ0FBQyxDQUFDO1FBQ3ZDLE1BQU0sQ0FBQztJQUNYLENBQUM7SUFFRCxZQUFFLENBQUMsVUFBVSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDO0lBRWxDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxTQUFTLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFFN0MsV0FBVyxDQUFDLEtBQUssRUFBRSxHQUFHLENBQUMsQ0FBQztBQUM1QixDQUFDO0FBRUQsSUFBSSxFQUFFLENBQUM7OztBQ3hFUCw2Q0FBNkM7O0FBRTdDLGlDQUErQztBQUUvQyxxQ0FNbUI7QUFFbkI7SUFBQTtJQXdEQSxDQUFDO0lBdERVLHFCQUFHLEdBQVYsVUFBVyxDQUFTLEVBQUUsQ0FBUyxFQUFFLEtBQWEsRUFBRSxNQUFjO1FBRTFELElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3hDLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO1FBQzNCLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFFcEMsK0JBQStCO1FBQy9CLFlBQUUsQ0FBQyxVQUFVLENBQUMsWUFBRSxDQUFDLGNBQWMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDM0MsQ0FBQztJQUVNLHdCQUFNLEdBQWIsVUFBYyxDQUFTLEVBQUUsQ0FBUyxFQUFFLFFBQWdCO1FBRWhELElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQ3hDLElBQUksQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO1FBQzNCLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxRQUFRLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFFekMsK0JBQStCO1FBQy9CLFlBQUUsQ0FBQyxVQUFVLENBQUMsWUFBRSxDQUFDLGNBQWMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDM0MsQ0FBQztJQUVPLHFDQUFtQixHQUEzQjtRQUVJLElBQUksVUFBVSxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUMvQixJQUFJLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFDakIsQ0FBQyxFQUFFLGlCQUFTLENBQUMsS0FBSyxHQUFHLGlCQUFTLENBQUMsS0FBSyxFQUNwQyxpQkFBUyxDQUFDLE1BQU0sR0FBRyxpQkFBUyxDQUFDLEtBQUssRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEQsWUFBRSxDQUFDLGdCQUFnQixDQUFDLHlCQUFlLEVBQUUsS0FBSyxFQUFFLFVBQVUsQ0FBQyxDQUFDO0lBQzVELENBQUM7SUFFTyw4QkFBWSxHQUFwQixVQUFxQixLQUFlO1FBRWhDLDJCQUEyQjtRQUMzQixZQUFFLENBQUMsVUFBVSxDQUFDLDZCQUFtQixDQUFDLENBQUM7UUFFbkMsdUNBQXVDO1FBQ3ZDLFlBQUUsQ0FBQyx1QkFBdUIsQ0FBQyx1Q0FBNkIsQ0FBQyxDQUFDO1FBRTFELFlBQVk7UUFDWixZQUFFLENBQUMsVUFBVSxDQUFDLHFCQUFXLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDdEMsQ0FBQztJQUVPLDJCQUFTLEdBQWpCLFVBQWtCLENBQVMsRUFBRSxDQUFTLEVBQUUsQ0FBUyxFQUFFLENBQVM7UUFFeEQsa0NBQWtDO1FBQ2xDLElBQUksTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUUzQixrQ0FBa0M7UUFDbEMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFDO1FBQzNELG9DQUFvQztRQUNwQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxNQUFNLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFFdkQsNkVBQTZFO1FBQzdFLFlBQUUsQ0FBQyxnQkFBZ0IsQ0FBQywwQkFBZ0IsRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7SUFDekQsQ0FBQztJQUNMLGNBQUM7QUFBRCxDQXhEQSxBQXdEQyxJQUFBO0FBeERZLDBCQUFPOzs7O0FDWnBCOzs7Ozs7R0FNRztBQUNILG1CQUEwQixHQUFHLEVBQUUsR0FBRztJQUU5QixNQUFNLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQyxHQUFHLEdBQUcsQ0FBQztBQUM3QyxDQUFDO0FBSEQsOEJBR0M7QUFFRDs7Ozs7O0dBTUc7QUFDSCxzQkFBNkIsR0FBRyxFQUFFLEdBQUc7SUFFakMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsR0FBRyxHQUFHLEdBQUcsR0FBRyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQztBQUM3RCxDQUFDO0FBSEQsb0NBR0M7Ozs7QUNyQkQsaUNBQXNEO0FBQ3RELG1DQUF3QztBQUV4QyxJQUFZLGNBR1g7QUFIRCxXQUFZLGNBQWM7SUFFdEIsbURBQUksQ0FBQTtJQUFFLCtDQUFFLENBQUE7SUFBRSxxREFBSyxDQUFBO0lBQUUsbURBQUksQ0FBQTtBQUN6QixDQUFDLEVBSFcsY0FBYyxHQUFkLHNCQUFjLEtBQWQsc0JBQWMsUUFHekI7QUFFRDtJQU1JO1FBSlEsaUJBQVksR0FBK0IsRUFBRSxDQUFDO1FBTWxELElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFLGlCQUFTLENBQUMsS0FBSyxHQUFHLENBQUMsRUFBRSxDQUFDLEVBQUUsaUJBQVMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUM1RSxJQUFJLENBQUMsVUFBVSxHQUFHLHFCQUFZLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBbUIsQ0FBQztRQUN2RCxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUM7SUFDckMsQ0FBQztJQUVNLG9CQUFJLEdBQVgsVUFBWSxLQUFZO1FBRXBCLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQztRQUNqQyxJQUFJLENBQUMsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUU1QyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQ3hCLENBQUM7WUFDRyxLQUFLLGNBQWMsQ0FBQyxJQUFJO2dCQUNwQixDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7Z0JBQ04sS0FBSyxDQUFDO1lBQ1YsS0FBSyxjQUFjLENBQUMsRUFBRTtnQkFDbEIsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO2dCQUNOLEtBQUssQ0FBQztZQUNWLEtBQUssY0FBYyxDQUFDLEtBQUs7Z0JBQ3JCLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztnQkFDTixLQUFLLENBQUM7WUFDVixLQUFLLGNBQWMsQ0FBQyxJQUFJO2dCQUNwQixDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7Z0JBQ04sS0FBSyxDQUFDO1FBQ2QsQ0FBQztRQUVELEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksaUJBQVMsQ0FBQyxLQUFLLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxpQkFBUyxDQUFDLE1BQU0sQ0FBQyxDQUM1RSxDQUFDO1lBQ0csTUFBTSxDQUFDLEtBQUssQ0FBQztRQUNqQixDQUFDO1FBRUQsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxpQkFBUyxDQUFDLFVBQVUsQ0FBQyxDQUNyRCxDQUFDO1lBQ0csTUFBTSxDQUFDLEtBQUssQ0FBQztRQUNqQixDQUFDO1FBRUQsSUFBSSxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFN0IsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxpQkFBUyxDQUFDLEtBQUssQ0FBQyxDQUNoRCxDQUFDO1lBQ0csS0FBSyxDQUFDLFFBQVEsQ0FBQyxpQkFBUyxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMvQyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMxRCxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMxRCxLQUFLLENBQUMsUUFBUSxDQUFDLGlCQUFTLENBQUMsS0FBSyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztZQUN0QyxJQUFJLENBQUMsWUFBWSxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBQzVCLENBQUM7UUFDRCxJQUFJLENBQ0osQ0FBQztZQUNHLEtBQUssQ0FBQyxRQUFRLENBQUMsaUJBQVMsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDL0MsS0FBSyxDQUFDLFFBQVEsRUFBRSxDQUFDO1FBQ3JCLENBQUM7UUFFRCxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLE1BQU0sSUFBSSxpQkFBUyxDQUFDLEtBQUssR0FBRyxpQkFBUyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FDdkUsQ0FBQztZQUNHLE1BQU0sQ0FBQyxLQUFLLENBQUM7UUFDakIsQ0FBQztRQUVELE1BQU0sQ0FBQyxJQUFJLENBQUM7SUFDaEIsQ0FBQztJQUVNLHdCQUFRLEdBQWYsVUFBZ0IsQ0FBaUI7UUFFN0IsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FDekIsQ0FBQztZQUNHLE1BQU0sQ0FBQztRQUNYLENBQUM7UUFFRCxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FDVixDQUFDO1lBQ0csS0FBSyxjQUFjLENBQUMsSUFBSTtnQkFDcEIsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSxjQUFjLENBQUMsS0FBSyxDQUFDLENBQzNDLENBQUM7b0JBQ0csTUFBTSxDQUFDO2dCQUNYLENBQUM7Z0JBQ0QsS0FBSyxDQUFDO1lBQ1YsS0FBSyxjQUFjLENBQUMsRUFBRTtnQkFDbEIsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSxjQUFjLENBQUMsSUFBSSxDQUFDLENBQzFDLENBQUM7b0JBQ0csTUFBTSxDQUFDO2dCQUNYLENBQUM7Z0JBQ0QsS0FBSyxDQUFDO1lBQ1YsS0FBSyxjQUFjLENBQUMsS0FBSztnQkFDckIsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSxjQUFjLENBQUMsSUFBSSxDQUFDLENBQzFDLENBQUM7b0JBQ0csTUFBTSxDQUFDO2dCQUNYLENBQUM7Z0JBQ0QsS0FBSyxDQUFDO1lBQ1YsS0FBSyxjQUFjLENBQUMsSUFBSTtnQkFDcEIsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFNBQVMsSUFBSSxjQUFjLENBQUMsRUFBRSxDQUFDLENBQ3hDLENBQUM7b0JBQ0csTUFBTSxDQUFDO2dCQUNYLENBQUM7Z0JBQ0QsS0FBSyxDQUFDO1FBQ2QsQ0FBQztRQUVELElBQUksQ0FBQyxVQUFVLEdBQUcsQ0FBQyxDQUFDO0lBQ3hCLENBQUM7SUFDTCxZQUFDO0FBQUQsQ0F6R0EsQUF5R0MsSUFBQTtBQXpHWSxzQkFBSyIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJcclxuaW1wb3J0IHsgUGFpbnRlciB9IGZyb20gXCIuL3BhaW50ZXJcIjtcclxuaW1wb3J0IHsgZ2V0UmFuZG9tSW50IH0gZnJvbSBcIi4vcmFuZG9tXCI7XHJcblxyXG5leHBvcnQgZW51bSBGaWVsZFNpemVcclxue1xyXG4gICAgV2lkdGggPSAyMCwgSGVpZ2h0ID0gMjBcclxufVxyXG5cclxuZXhwb3J0IGVudW0gQmxvY2tTaXplXHJcbntcclxuICAgIFdpZHRoID0gMTAsIEhlaWdodCA9IDEwXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIEJsb2NrVHlwZVxyXG57XHJcbiAgICBFbXB0eSwgU25ha2VCbG9jaywgRnJ1aXRcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEZpZWxkXHJcbntcclxuICAgIHByaXZhdGUgX206IGFueVtdID0gW107XHJcblxyXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKClcclxuICAgIHtcclxuICAgICAgICBmb3IgKGxldCB5ID0gMDsgeSA8IEZpZWxkU2l6ZS5IZWlnaHQ7ICsreSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGxldCBjb2x1bW5zOiBCbG9ja1R5cGVbXSA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IEZpZWxkU2l6ZS5XaWR0aDsgKyt4KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBjb2x1bW5zW3hdID0gQmxvY2tUeXBlLkVtcHR5O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuX21beV0gPSBjb2x1bW5zO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLk5ld0ZydWl0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIFNldEJsb2NrKHR5cGU6IEJsb2NrVHlwZSwgeDogbnVtYmVyLCB5OiBudW1iZXIpXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5fbVt5XVt4XSA9IHR5cGU7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIEdldEJsb2NrKHg6IG51bWJlciwgeTogbnVtYmVyKTogQmxvY2tUeXBlXHJcbiAgICB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX21beV1beF07XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIERyYXcocDogUGFpbnRlcik6IHZvaWRcclxuICAgIHtcclxuICAgICAgICBmb3IgKGxldCB5ID0gMDsgeSA8IEZpZWxkU2l6ZS5IZWlnaHQ7ICsreSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgRmllbGRTaXplLldpZHRoOyArK3gpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAodGhpcy5fbVt5XVt4XSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIEJsb2NrVHlwZS5FbXB0eTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBCbG9ja1R5cGUuU25ha2VCbG9jazpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcC5CYXIoeCAqIEJsb2NrU2l6ZS5XaWR0aCArIEJsb2NrU2l6ZS5XaWR0aCAvIDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ICogQmxvY2tTaXplLkhlaWdodCArIEJsb2NrU2l6ZS5IZWlnaHQgLyAyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQmxvY2tTaXplLldpZHRoIC0gMSwgQmxvY2tTaXplLkhlaWdodCAtIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIEJsb2NrVHlwZS5GcnVpdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcC5DaXJjbGUoeCAqIEJsb2NrU2l6ZS5XaWR0aCArIEJsb2NrU2l6ZS5XaWR0aCAvIDIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ICogQmxvY2tTaXplLkhlaWdodCArIEJsb2NrU2l6ZS5IZWlnaHQgLyAyLCBCbG9ja1NpemUuV2lkdGggLSAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIE5ld0ZydWl0KCk6IHZvaWRcclxuICAgIHtcclxuICAgICAgICBsZXQgeDogbnVtYmVyO1xyXG4gICAgICAgIGxldCB5OiBudW1iZXI7XHJcbiAgICAgICAgZG9cclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHggPSBnZXRSYW5kb21JbnQoMCwgRmllbGRTaXplLldpZHRoIC0gMSk7XHJcbiAgICAgICAgICAgIHkgPSBnZXRSYW5kb21JbnQoMCwgRmllbGRTaXplLkhlaWdodCAtIDEpO1xyXG4gICAgICAgIH0gd2hpbGUgKHRoaXMuR2V0QmxvY2soeCwgeSkgIT0gQmxvY2tUeXBlLkVtcHR5KTtcclxuICAgICAgICB0aGlzLlNldEJsb2NrKEJsb2NrVHlwZS5GcnVpdCwgeCwgeSk7XHJcbiAgICB9XHJcbn0iLCJcclxuaW1wb3J0IHsgUGFpbnRlciB9IGZyb20gXCIuL3BhaW50ZXJcIjtcclxuaW1wb3J0IHsgRmllbGQgfSBmcm9tIFwiLi9maWVsZFwiO1xyXG5pbXBvcnQgeyBTbmFrZSwgU25ha2VEaXJlY3Rpb24gfSBmcm9tIFwiLi9zbmFrZVwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEdhbWVcclxue1xyXG4gICAgcHJpdmF0ZSBfZmllbGQ6IEZpZWxkID0gbnVsbDtcclxuICAgIHByaXZhdGUgX3NuYWtlOiBTbmFrZSA9IG51bGw7XHJcblxyXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKClcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9maWVsZCA9IG5ldyBGaWVsZCgpO1xyXG4gICAgICAgIHRoaXMuX3NuYWtlID0gbmV3IFNuYWtlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIFRpY2soKTogdm9pZFxyXG4gICAge1xyXG4gICAgICAgIGlmICghdGhpcy5fc25ha2UuVGljayh0aGlzLl9maWVsZCkpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLl9maWVsZCA9IG5ldyBGaWVsZCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9zbmFrZSA9IG5ldyBTbmFrZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgRHJhdyhwOiBQYWludGVyKTogdm9pZFxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX2ZpZWxkLkRyYXcocCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIEtleUV2ZW50KGQ6IFNuYWtlRGlyZWN0aW9uKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMuX3NuYWtlLktleUV2ZW50KGQpO1xyXG4gICAgfVxyXG59IiwiXHJcbmV4cG9ydCBsZXQgZ2w6IFdlYkdMUmVuZGVyaW5nQ29udGV4dCA9IG51bGw7XHJcbmV4cG9ydCBsZXQgc2ltcGxlU2hhZGVyUHJvZ3JhbTogV2ViR0xQcm9ncmFtID0gbnVsbDtcclxuZXhwb3J0IGxldCBzaGFkZXJWZXJ0ZXhQb3NpdGlvbkF0dHJpYnV0ZTogbnVtYmVyO1xyXG5leHBvcnQgbGV0IHVfRnJhZ0NvbG9yOiBXZWJHTFVuaWZvcm1Mb2NhdGlvbiA9IG51bGw7XHJcbmV4cG9ydCBsZXQgdV9Nb2RlbFRyYW5zZm9ybTogV2ViR0xVbmlmb3JtTG9jYXRpb24gPSBudWxsO1xyXG5leHBvcnQgbGV0IHVfUHJvalRyYW5zZm9ybTogV2ViR0xVbmlmb3JtTG9jYXRpb24gPSBudWxsO1xyXG5cclxubGV0IGdTcXVhcmVWZXJ0ZXhCdWZmZXI6IFdlYkdMQnVmZmVyID0gbnVsbDtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBpbml0R0woY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCk6IGJvb2xlYW5cclxue1xyXG4gICAgLy8gR2V0IHRoZSByZW5kZXJpbmcgY29udGV4dFxyXG4gICAgZ2wgPSBnZXRXZWJHTENvbnRleHQoY2FudmFzKTtcclxuICAgIGlmIChnbCA9PSBudWxsKVxyXG4gICAge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiRmFpbGVkIHRvIGdldCB0aGUgcmVuZGVyaW5nIGNvbnRleHRcIik7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGluaXRTcXVhcmVCdWZmZXIoKTtcclxuXHJcbiAgICBpZiAoIWluaXRTaW1wbGVTaGFkZXIoXCJWZXJ0ZXhTaGFkZXJcIiwgXCJGcmFnbWVudFNoYWRlclwiKSlcclxuICAgIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgdV9GcmFnQ29sb3IgPSBnbC5nZXRVbmlmb3JtTG9jYXRpb24oc2ltcGxlU2hhZGVyUHJvZ3JhbSwgXCJ1X0ZyYWdDb2xvclwiKTtcclxuICAgIGlmICghdV9GcmFnQ29sb3IpXHJcbiAgICB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJGYWlsZWQgdG8gZ2V0IHVfRnJhZ0NvbG9yIGxvY2F0aW9uXCIpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICB1X01vZGVsVHJhbnNmb3JtID0gZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKHNpbXBsZVNoYWRlclByb2dyYW0sIFwidV9Nb2RlbFRyYW5zZm9ybVwiKTtcclxuICAgIGlmICghdV9Nb2RlbFRyYW5zZm9ybSlcclxuICAgIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkZhaWxlZCB0byBnZXQgdV9Nb2RlbFRyYW5zZnJvbSBsb2NhdGlvblwiKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgdV9Qcm9qVHJhbnNmb3JtID0gZ2wuZ2V0VW5pZm9ybUxvY2F0aW9uKHNpbXBsZVNoYWRlclByb2dyYW0sIFwidV9Qcm9qVHJhbnNmb3JtXCIpO1xyXG4gICAgaWYgKCF1X1Byb2pUcmFuc2Zvcm0pXHJcbiAgICB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJGYWlsZSB0byBnZXQgdV9Qcm9qVHJhbnNmb3JtIGxvY2F0aW9uXCIpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0V2ViR0xDb250ZXh0KGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQpOiBXZWJHTFJlbmRlcmluZ0NvbnRleHRcclxue1xyXG4gICAgbGV0IGdsOiBXZWJHTFJlbmRlcmluZ0NvbnRleHQgPSBudWxsO1xyXG5cclxuICAgIHRyeVxyXG4gICAge1xyXG4gICAgICAgIGdsID0gY2FudmFzLmdldENvbnRleHQoXCJ3ZWJnbFwiKSB8fCBjYW52YXMuZ2V0Q29udGV4dChcImV4cGVyaW1lbnRhbC13ZWJnbFwiKTtcclxuXHJcbiAgICAgICAgaWYgKGdsID09IG51bGwpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aHJvdyBcIkJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBXZWJHTFwiO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGNhdGNoIChlKVxyXG4gICAge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGUpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBnbDtcclxufVxyXG5cclxuZnVuY3Rpb24gaW5pdFNxdWFyZUJ1ZmZlcigpOiB2b2lkXHJcbntcclxuICAgIC8vIERlZmluZSB0aGUgdmVydGljZXMgZm9yIGEgc3F1YXJlXHJcbiAgICBsZXQgdmVydGljZXNPZlNxdWFyZSA9IFtcclxuICAgICAgICAwLjUsIDAuNSwgMC4wLFxyXG4gICAgICAgIC0wLjUsIDAuNSwgMC4wLFxyXG4gICAgICAgIDAuNSwgLTAuNSwgMC4wLFxyXG4gICAgICAgIC0wLjUsIC0wLjUsIDAuMCxcclxuXHJcbiAgICAgICAgMC4wLCAwLjUsIDAuMCxcclxuICAgICAgICAtMC41LCAwLjAsIDAuMCxcclxuICAgICAgICAwLjUsIDAuMCwgMC4wLFxyXG4gICAgICAgIDAuMCwgLTAuNSwgMC4wXHJcbiAgICBdO1xyXG5cclxuICAgIC8vIENyZWF0ZSBhIGJ1ZmZlciBvbiB0aGUgZ2wgY29udGV4dFxyXG4gICAgZ1NxdWFyZVZlcnRleEJ1ZmZlciA9IGdsLmNyZWF0ZUJ1ZmZlcigpO1xyXG5cclxuICAgIC8vIEFjdGl2YXRlIHZlcnRleEJ1ZmZlclxyXG4gICAgZ2wuYmluZEJ1ZmZlcihnbC5BUlJBWV9CVUZGRVIsIGdTcXVhcmVWZXJ0ZXhCdWZmZXIpO1xyXG5cclxuICAgIC8vIExvYWRzIHZlcnRpY2VzT2ZTcXVhcmUgaW50byB0aGUgdmVydGV4QnVmZmVyXHJcbiAgICBnbC5idWZmZXJEYXRhKGdsLkFSUkFZX0JVRkZFUiwgbmV3IEZsb2F0MzJBcnJheSh2ZXJ0aWNlc09mU3F1YXJlKSwgZ2wuU1RBVElDX0RSQVcpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpbml0U2ltcGxlU2hhZGVyKHZlcnRleFNoYWRlcklEOiBzdHJpbmcsIGZyYWdtZW50U2hhZGVySUQ6IHN0cmluZyk6IGJvb2xlYW5cclxue1xyXG4gICAgLy8gTG9hZCBhbmQgY29tcGlsZSB2ZXJ0ZXggYW5kIGZyYWdtZW50IHNoYWRlcnNcclxuICAgIGxldCB2ZXJ0ZXhTaGFkZXIgPSBsb2FkQW5kQ29tcGlsZVNoYWRlcih2ZXJ0ZXhTaGFkZXJJRCwgZ2wuVkVSVEVYX1NIQURFUik7XHJcbiAgICBsZXQgZnJhZ21lbnRTaGFkZXIgPSBsb2FkQW5kQ29tcGlsZVNoYWRlcihmcmFnbWVudFNoYWRlcklELCBnbC5GUkFHTUVOVF9TSEFERVIpO1xyXG4gICAgaWYgKCF2ZXJ0ZXhTaGFkZXIgfHwgIWZyYWdtZW50U2hhZGVyKVxyXG4gICAge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDcmVhdGUgYW5kIGxpbmsgdGhlIHNoYWRlcnMgdG8gYSBwcm9ncmFtXHJcbiAgICBzaW1wbGVTaGFkZXJQcm9ncmFtID0gZ2wuY3JlYXRlUHJvZ3JhbSgpO1xyXG4gICAgZ2wuYXR0YWNoU2hhZGVyKHNpbXBsZVNoYWRlclByb2dyYW0sIHZlcnRleFNoYWRlcik7XHJcbiAgICBnbC5hdHRhY2hTaGFkZXIoc2ltcGxlU2hhZGVyUHJvZ3JhbSwgZnJhZ21lbnRTaGFkZXIpO1xyXG4gICAgZ2wubGlua1Byb2dyYW0oc2ltcGxlU2hhZGVyUHJvZ3JhbSk7XHJcblxyXG4gICAgLy8gQ2hlY2sgZm9yIGVycm9yXHJcbiAgICBpZiAoIWdsLmdldFByb2dyYW1QYXJhbWV0ZXIoc2ltcGxlU2hhZGVyUHJvZ3JhbSwgZ2wuTElOS19TVEFUVVMpKVxyXG4gICAge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiRXJyb3IgbGlua2luZyBzaGFkZXJcIik7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEdldHMgYSByZWZlcmVuY2UgdG8gdGhlIGFfUG9zaXRpb24gdmFyaWFibGUgd2l0aGluIHRoZSBzaGFkZXJzXHJcbiAgICBzaGFkZXJWZXJ0ZXhQb3NpdGlvbkF0dHJpYnV0ZSA9IGdsLmdldEF0dHJpYkxvY2F0aW9uKHNpbXBsZVNoYWRlclByb2dyYW0sIFwiYV9Qb3NpdGlvblwiKTtcclxuICAgIGlmIChzaGFkZXJWZXJ0ZXhQb3NpdGlvbkF0dHJpYnV0ZSA8IDApXHJcbiAgICB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJGYWlsZWQgdG8gZ2V0IGEgcmVmZXJlbmNlIHRvIHRoZSBhX1Bvc2l0aW9uIHZhcmlhYmxlXCIpXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEFjdGl2YXRlcyB0aGUgdmVydGV4IGJ1ZmZlclxyXG4gICAgZ2wuYmluZEJ1ZmZlcihnbC5BUlJBWV9CVUZGRVIsIGdTcXVhcmVWZXJ0ZXhCdWZmZXIpO1xyXG5cclxuICAgIC8vIERpc2NyaWJlIHRoZSBjaGFyYWN0ZXJpc3RpYyBvZiB0aGUgdmVydGV4IHBvc2l0aW9uIGF0dHJpYnV0ZVxyXG4gICAgZ2wudmVydGV4QXR0cmliUG9pbnRlcihzaGFkZXJWZXJ0ZXhQb3NpdGlvbkF0dHJpYnV0ZSxcclxuICAgICAgICAzLCAgICAgICAgICAvLyBlYWNoIHZlcnRleCBlbGVtZW50IGlzIGEgMy1mbG9hdCAoeCwgeSwgeilcclxuICAgICAgICBnbC5GTE9BVCwgICAvLyBkYXRhIHR5cGUgaXMgRkxPQVRcclxuICAgICAgICBmYWxzZSwgICAgICAvLyBpZiB0aGUgY29udGVudCBpcyBub3JtYWxpemVkIHZlY3RvcnNcclxuICAgICAgICAwLCAgICAgICAgICAvLyBudW1iZXIgb2YgYnl0ZXMgdG8gc2tpcCBpbiBiaXR3ZWVuIGVsZW1lbnRzXHJcbiAgICAgICAgMCAgICAgICAgICAgLy8gb2Zmc2V0cyB0byB0aGUgZmlyc3QgZWxlbWVudFxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4gdHJ1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gbG9hZEFuZENvbXBpbGVTaGFkZXIoaWQ6IHN0cmluZywgc2hhZGVyVHlwZTogbnVtYmVyKTogV2ViR0xTaGFkZXJcclxue1xyXG4gICAgLy8gR2V0IHRoZSBzaGFkZXIgc291cmNlIGZyb20gaW5kZXguaHRtbFxyXG4gICAgbGV0IHNoYWRlclRleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XHJcbiAgICBsZXQgc2hhZGVyU291cmNlID0gc2hhZGVyVGV4dC5maXJzdENoaWxkLnRleHRDb250ZW50O1xyXG5cclxuICAgIC8vIENyZWF0ZSB0aGUgc2hhZGVyIGJhc2VkIG9uIHRoZSBzaGFkZXIgdHlwZTogdmVydGV4IG9yIGZyYWdtZW50XHJcbiAgICBsZXQgY29tcGlsZWRTaGFkZXIgPSBnbC5jcmVhdGVTaGFkZXIoc2hhZGVyVHlwZSk7XHJcblxyXG4gICAgLy8gQ29tcGlsZSB0aGUgY3JlYXRlZCBzaGFkZXJcclxuICAgIGdsLnNoYWRlclNvdXJjZShjb21waWxlZFNoYWRlciwgc2hhZGVyU291cmNlKTtcclxuICAgIGdsLmNvbXBpbGVTaGFkZXIoY29tcGlsZWRTaGFkZXIpO1xyXG5cclxuICAgIC8vIENoZWNrIGZvciBlcnJvcnMgYW5kIHJldHVybiByZXN1bHRzIChudWxsIGlmIGVycm9yKVxyXG4gICAgaWYgKCFnbC5nZXRTaGFkZXJQYXJhbWV0ZXIoY29tcGlsZWRTaGFkZXIsIGdsLkNPTVBJTEVfU1RBVFVTKSlcclxuICAgIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgQSBzaGFkZXIgY29tcGlsaW5nIGVycm9yIG9jY3VyZWQ6ICR7Z2wuZ2V0U2hhZGVySW5mb0xvZyhjb21waWxlZFNoYWRlcil9YCk7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGNvbXBpbGVkU2hhZGVyO1xyXG59IiwiXHJcbmltcG9ydCB7IFBhaW50ZXIgfSBmcm9tIFwiLi9wYWludGVyXCI7XHJcbmltcG9ydCB7IEdhbWUgfSBmcm9tIFwiLi9nYW1lXCI7XHJcbmltcG9ydCB7IFNuYWtlRGlyZWN0aW9uIH0gZnJvbSBcIi4vc25ha2VcIjtcclxuXHJcbmltcG9ydFxyXG57XHJcbiAgICBnbCwgaW5pdEdMXHJcbn0gZnJvbSBcIi4vZ2xvYmFsc1wiO1xyXG5cclxubGV0IGdhbWUgPSBuZXcgR2FtZSgpO1xyXG5sZXQgcGFpbnRlciA9IG5ldyBQYWludGVyKCk7XHJcblxyXG5mdW5jdGlvbiBkaXNwbGF5KClcclxue1xyXG4gICAgZ2wuY2xlYXIoZ2wuQ09MT1JfQlVGRkVSX0JJVCk7XHJcbiAgICBnYW1lLkRyYXcocGFpbnRlcik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRpbWVyKClcclxue1xyXG4gICAgZ2FtZS5UaWNrKCk7XHJcbiAgICBkaXNwbGF5KCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGtleUV2ZW50KGV2ZW50OiBLZXlib2FyZEV2ZW50KVxyXG57XHJcbiAgICBzd2l0Y2ggKGV2ZW50LmtleUNvZGUpXHJcbiAgICB7XHJcbiAgICAgICAgY2FzZSA2NTogLy8gQVxyXG4gICAgICAgIGNhc2UgMzc6IC8vIExlZnQgQXJyb3dcclxuICAgICAgICAgICAgZ2FtZS5LZXlFdmVudChTbmFrZURpcmVjdGlvbi5MZWZ0KTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSA4NzogLy8gV1xyXG4gICAgICAgIGNhc2UgMzg6IC8vIFVwIEFycm93XHJcbiAgICAgICAgICAgIGdhbWUuS2V5RXZlbnQoU25ha2VEaXJlY3Rpb24uVXApO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIDY4OiAvLyBEXHJcbiAgICAgICAgY2FzZSAzOTogLy8gUmlnaHQgQXJyb3dcclxuICAgICAgICAgICAgZ2FtZS5LZXlFdmVudChTbmFrZURpcmVjdGlvbi5SaWdodCk7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgODM6IC8vIFNcclxuICAgICAgICBjYXNlIDQwOiAvLyBEb3duIEFycm93XHJcbiAgICAgICAgICAgIGdhbWUuS2V5RXZlbnQoU25ha2VEaXJlY3Rpb24uRG93bik7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBtYWluKClcclxue1xyXG4gICAgLy8gUmV0cmlldmUgdGhlIGNhbnZhcyBlbGVtZW50XHJcbiAgICBsZXQgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZW5kZXJDYW52YXNcIikgYXMgSFRNTENhbnZhc0VsZW1lbnQ7XHJcbiAgICBpZiAoY2FudmFzID09IG51bGwpXHJcbiAgICB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJGYWlsZWQgdG8gcmV0cmlldmUgdGhlIGNhbnZhcyBlbGVtZW50XCIpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBJbml0aWFsaXplIEdMXHJcbiAgICBpZiAoIWluaXRHTChjYW52YXMpKVxyXG4gICAge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiRmFpbGVkIHRvIGluaXRpYWxpemUgR0xcIik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGdsLmNsZWFyQ29sb3IoMC4wLCAwLjAsIDAuMCwgMS4wKTtcclxuXHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwga2V5RXZlbnQpO1xyXG5cclxuICAgIHNldEludGVydmFsKHRpbWVyLCAzMDApO1xyXG59XHJcblxyXG5tYWluKCk7XHJcbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuL2xpYi9nbC1tYXRyaXguZC50c1wiIC8+XHJcblxyXG5pbXBvcnQgeyBGaWVsZFNpemUsIEJsb2NrU2l6ZSB9IGZyb20gXCIuL2ZpZWxkXCI7XHJcblxyXG5pbXBvcnRcclxue1xyXG4gICAgZ2wsIHNpbXBsZVNoYWRlclByb2dyYW0sXHJcbiAgICBzaGFkZXJWZXJ0ZXhQb3NpdGlvbkF0dHJpYnV0ZSxcclxuICAgIHVfRnJhZ0NvbG9yLCB1X01vZGVsVHJhbnNmb3JtLFxyXG4gICAgdV9Qcm9qVHJhbnNmb3JtXHJcbn0gZnJvbSBcIi4vZ2xvYmFsc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBhaW50ZXJcclxue1xyXG4gICAgcHVibGljIEJhcih4OiBudW1iZXIsIHk6IG51bWJlciwgd2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpOiB2b2lkXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5BY3RpdmVTaGFkZXIoWzAuMCwgMS4wLCAwLjAsIDEuMF0pO1xyXG4gICAgICAgIHRoaXMuU2V0UHJvamVjdGlvbk1hdHJpeCgpO1xyXG4gICAgICAgIHRoaXMuVHJhbnNmb3JtKHgsIHksIHdpZHRoLCBoZWlnaHQpO1xyXG5cclxuICAgICAgICAvLyBEcmF3IHdpdGggdGhlIGFib3ZlIHNldHRpbmdzXHJcbiAgICAgICAgZ2wuZHJhd0FycmF5cyhnbC5UUklBTkdMRV9TVFJJUCwgMCwgNCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIENpcmNsZSh4OiBudW1iZXIsIHk6IG51bWJlciwgZGlhbWV0ZXI6IG51bWJlcik6IHZvaWRcclxuICAgIHtcclxuICAgICAgICB0aGlzLkFjdGl2ZVNoYWRlcihbMS4wLCAwLjAsIDAuMCwgMS4wXSk7XHJcbiAgICAgICAgdGhpcy5TZXRQcm9qZWN0aW9uTWF0cml4KCk7XHJcbiAgICAgICAgdGhpcy5UcmFuc2Zvcm0oeCwgeSwgZGlhbWV0ZXIsIGRpYW1ldGVyKTtcclxuXHJcbiAgICAgICAgLy8gRHJhdyB3aXRoIHRoZSBhYm92ZSBzZXR0aW5nc1xyXG4gICAgICAgIGdsLmRyYXdBcnJheXMoZ2wuVFJJQU5HTEVfU1RSSVAsIDQsIDQpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgU2V0UHJvamVjdGlvbk1hdHJpeCgpXHJcbiAgICB7XHJcbiAgICAgICAgbGV0IHByb2pNYXRyaXggPSBtYXQ0LmNyZWF0ZSgpO1xyXG4gICAgICAgIG1hdDQub3J0aG8ocHJvak1hdHJpeCxcclxuICAgICAgICAgICAgMCwgRmllbGRTaXplLldpZHRoICogQmxvY2tTaXplLldpZHRoLFxyXG4gICAgICAgICAgICBGaWVsZFNpemUuSGVpZ2h0ICogQmxvY2tTaXplLldpZHRoLCAwLCAxLCAtMSk7XHJcbiAgICAgICAgZ2wudW5pZm9ybU1hdHJpeDRmdih1X1Byb2pUcmFuc2Zvcm0sIGZhbHNlLCBwcm9qTWF0cml4KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIEFjdGl2ZVNoYWRlcihjb2xvcjogbnVtYmVyW10pXHJcbiAgICB7XHJcbiAgICAgICAgLy8gRW5hYmxlIHRoZSBzaGFkZXIgdG8gdXNlXHJcbiAgICAgICAgZ2wudXNlUHJvZ3JhbShzaW1wbGVTaGFkZXJQcm9ncmFtKTtcclxuXHJcbiAgICAgICAgLy8gRW5hYmxlIHRoZSB2ZXJ0ZXggcG9zaXRpb24gYXR0cmlidXRlXHJcbiAgICAgICAgZ2wuZW5hYmxlVmVydGV4QXR0cmliQXJyYXkoc2hhZGVyVmVydGV4UG9zaXRpb25BdHRyaWJ1dGUpO1xyXG5cclxuICAgICAgICAvLyBTZXQgQ29sb3JcclxuICAgICAgICBnbC51bmlmb3JtNGZ2KHVfRnJhZ0NvbG9yLCBjb2xvcik7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBUcmFuc2Zvcm0oeDogbnVtYmVyLCB5OiBudW1iZXIsIHc6IG51bWJlciwgaDogbnVtYmVyKVxyXG4gICAge1xyXG4gICAgICAgIC8vIENyZWF0ZXMgYSBibGFuayBpZGVudGl0eSBtYXRyaXhcclxuICAgICAgICBsZXQgbWF0cml4ID0gbWF0NC5jcmVhdGUoKTtcclxuXHJcbiAgICAgICAgLy8gQ29tcHV0ZSB0cmFuc2xhdGlvbiBhbmQgc2NhbGluZ1xyXG4gICAgICAgIG1hdDQudHJhbnNsYXRlKG1hdHJpeCwgbWF0cml4LCB2ZWMzLmZyb21WYWx1ZXMoeCwgeSwgMC4wKSk7XHJcbiAgICAgICAgLy9tYXQ0LnJvdGF0ZVoobWF0cml4LCBtYXRyaXgsIDAuMCk7XHJcbiAgICAgICAgbWF0NC5zY2FsZShtYXRyaXgsIG1hdHJpeCwgdmVjMy5mcm9tVmFsdWVzKHcsIGgsIDEuMCkpO1xyXG5cclxuICAgICAgICAvLyBMb2FkcyB0aGUgbW9kZWxUcmFuc2Zvcm0gbWF0cml4IGludG8gV2ViR0wgdG8gYmUgdXNlZCBieSB0aGUgdmVydGV4IHNoYWRlclxyXG4gICAgICAgIGdsLnVuaWZvcm1NYXRyaXg0ZnYodV9Nb2RlbFRyYW5zZm9ybSwgZmFsc2UsIG1hdHJpeCk7XHJcbiAgICB9XHJcbn0iLCIvKipcclxuICogR2V0IGEgcmFuZG9tIGZsb2F0aW5nIHBvaW50IG51bWJlciBiZXR3ZWVuIGBtaW5gIGFuZCBgbWF4YC5cclxuICogXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSBtaW4gLSBtaW4gbnVtYmVyXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSBtYXggLSBtYXggbnVtYmVyXHJcbiAqIEByZXR1cm4ge2Zsb2F0fSBhIHJhbmRvbSBmbG9hdGluZyBwb2ludCBudW1iZXJcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXRSYW5kb20obWluLCBtYXgpXHJcbntcclxuICAgIHJldHVybiBNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbikgKyBtaW47XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgYSByYW5kb20gaW50ZWdlciBiZXR3ZWVuIGBtaW5gIGFuZCBgbWF4YC5cclxuICogXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSBtaW4gLSBtaW4gbnVtYmVyXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSBtYXggLSBtYXggbnVtYmVyXHJcbiAqIEByZXR1cm4ge2ludH0gYSByYW5kb20gaW50ZWdlclxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFJhbmRvbUludChtaW4sIG1heClcclxue1xyXG4gICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSArIG1pbik7XHJcbn1cclxuIiwiXHJcbmltcG9ydCB7IEZpZWxkLCBGaWVsZFNpemUsIEJsb2NrVHlwZSB9IGZyb20gXCIuL2ZpZWxkXCI7XHJcbmltcG9ydCB7IGdldFJhbmRvbUludCB9IGZyb20gXCIuL3JhbmRvbVwiO1xyXG5cclxuZXhwb3J0IGVudW0gU25ha2VEaXJlY3Rpb25cclxue1xyXG4gICAgTGVmdCwgVXAsIFJpZ2h0LCBEb3duXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBTbmFrZVxyXG57XHJcbiAgICBwcml2YXRlIF9zbmFrZUJsb2NrczogeyB4OiBudW1iZXIsIHk6IG51bWJlciB9W10gPSBbXTtcclxuICAgIHByaXZhdGUgX2RpcmVjdGlvbjogU25ha2VEaXJlY3Rpb247XHJcbiAgICBwcml2YXRlIF9sYXN0TW92ZTogU25ha2VEaXJlY3Rpb247XHJcblxyXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKClcclxuICAgIHtcclxuICAgICAgICB0aGlzLl9zbmFrZUJsb2Nrcy5wdXNoKHsgeDogRmllbGRTaXplLldpZHRoIC8gMiwgeTogRmllbGRTaXplLkhlaWdodCAvIDIgfSk7XHJcbiAgICAgICAgdGhpcy5fZGlyZWN0aW9uID0gZ2V0UmFuZG9tSW50KDAsIDMpIGFzIFNuYWtlRGlyZWN0aW9uO1xyXG4gICAgICAgIHRoaXMuX2xhc3RNb3ZlID0gdGhpcy5fZGlyZWN0aW9uO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBUaWNrKGZpZWxkOiBGaWVsZCk6IGJvb2xlYW5cclxuICAgIHtcclxuICAgICAgICB0aGlzLl9sYXN0TW92ZSA9IHRoaXMuX2RpcmVjdGlvbjtcclxuICAgICAgICBsZXQgcCA9IE9iamVjdC5jcmVhdGUodGhpcy5fc25ha2VCbG9ja3NbMF0pO1xyXG5cclxuICAgICAgICBzd2l0Y2ggKHRoaXMuX2RpcmVjdGlvbilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGNhc2UgU25ha2VEaXJlY3Rpb24uTGVmdDpcclxuICAgICAgICAgICAgICAgIHAueC0tO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgU25ha2VEaXJlY3Rpb24uVXA6XHJcbiAgICAgICAgICAgICAgICBwLnktLTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFNuYWtlRGlyZWN0aW9uLlJpZ2h0OlxyXG4gICAgICAgICAgICAgICAgcC54Kys7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBTbmFrZURpcmVjdGlvbi5Eb3duOlxyXG4gICAgICAgICAgICAgICAgcC55Kys7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChwLnggPCAwIHx8IHAueCA+PSBGaWVsZFNpemUuV2lkdGggfHwgcC55IDwgMCB8fCBwLnkgPj0gRmllbGRTaXplLkhlaWdodClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChmaWVsZC5HZXRCbG9jayhwLngsIHAueSkgPT0gQmxvY2tUeXBlLlNuYWtlQmxvY2spXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9zbmFrZUJsb2Nrcy51bnNoaWZ0KHApO1xyXG5cclxuICAgICAgICBpZiAoZmllbGQuR2V0QmxvY2socC54LCBwLnkpICE9IEJsb2NrVHlwZS5GcnVpdClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGZpZWxkLlNldEJsb2NrKEJsb2NrVHlwZS5TbmFrZUJsb2NrLCBwLngsIHAueSk7XHJcbiAgICAgICAgICAgIGxldCB4ID0gdGhpcy5fc25ha2VCbG9ja3NbdGhpcy5fc25ha2VCbG9ja3MubGVuZ3RoIC0gMV0ueDtcclxuICAgICAgICAgICAgbGV0IHkgPSB0aGlzLl9zbmFrZUJsb2Nrc1t0aGlzLl9zbmFrZUJsb2Nrcy5sZW5ndGggLSAxXS55O1xyXG4gICAgICAgICAgICBmaWVsZC5TZXRCbG9jayhCbG9ja1R5cGUuRW1wdHksIHgsIHkpO1xyXG4gICAgICAgICAgICB0aGlzLl9zbmFrZUJsb2Nrcy5wb3AoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgZmllbGQuU2V0QmxvY2soQmxvY2tUeXBlLlNuYWtlQmxvY2ssIHAueCwgcC55KTtcclxuICAgICAgICAgICAgZmllbGQuTmV3RnJ1aXQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9zbmFrZUJsb2Nrcy5sZW5ndGggPj0gRmllbGRTaXplLldpZHRoICogRmllbGRTaXplLkhlaWdodCAtIDEpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgS2V5RXZlbnQoZDogU25ha2VEaXJlY3Rpb24pXHJcbiAgICB7XHJcbiAgICAgICAgaWYgKGQgPT0gdGhpcy5fZGlyZWN0aW9uKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc3dpdGNoIChkKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgY2FzZSBTbmFrZURpcmVjdGlvbi5MZWZ0OlxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2xhc3RNb3ZlID09IFNuYWtlRGlyZWN0aW9uLlJpZ2h0KVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFNuYWtlRGlyZWN0aW9uLlVwOlxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2xhc3RNb3ZlID09IFNuYWtlRGlyZWN0aW9uLkRvd24pXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgU25ha2VEaXJlY3Rpb24uUmlnaHQ6XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbGFzdE1vdmUgPT0gU25ha2VEaXJlY3Rpb24uTGVmdClcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSBTbmFrZURpcmVjdGlvbi5Eb3duOlxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2xhc3RNb3ZlID09IFNuYWtlRGlyZWN0aW9uLlVwKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fZGlyZWN0aW9uID0gZDtcclxuICAgIH1cclxufSJdfQ=="}
